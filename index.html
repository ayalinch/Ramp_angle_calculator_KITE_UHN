<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>KITE Ramp Simulator — Stable Non-Module Build</title>
<style>
  body { margin:0; overflow:hidden; background:#111827; font-family:-apple-system, sans-serif; }
  #ui {
    position:fixed; top:20px; left:20px; z-index:10;
    background:rgba(255,255,255,0.08); padding:14px 18px;
    border-radius:12px; backdrop-filter:blur(10px);
    color:white; font-size:14px; width:220px;
  }
  label { display:block; margin-top:8px; font-weight:600; }
  input[type=range], select, input[type=color] { width:100%; margin-top:4px; }
</style>

<!-- ✅ GLOBAL THREE.JS (NO MODULES, ALWAYS WORKS) -->
<script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.152.2/examples/js/controls/OrbitControls.js"></script>

</head>
<body>

<div id="ui">
  <label>Ramp Angle</label>
  <input id="angle" type="range" min="0" max="25" value="7"/>

  <label>Walk Speed</label>
  <input id="speed" type="range" min="0.2" max="3" step="0.1" value="1.2"/>

  <label>Person Color</label>
  <input id="personColor" type="color" value="#ffffff"/>

  <label>Ramp Color</label>
  <input id="rampColor" type="color" value="#818181"/>
</div>

<script>
let scene = new THREE.Scene();
scene.background = new THREE.Color("#111827");

let camera = new THREE.PerspectiveCamera(55, innerWidth/innerHeight, 0.1, 100);
camera.position.set(5,3,6);

let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

let controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

scene.add(new THREE.AmbientLight(0xffffff, 0.7));
let dl = new THREE.DirectionalLight(0xffffff, 1.2);
dl.position.set(5,10,5);
scene.add(dl);

// Ramp
let ramp = new THREE.Mesh(
  new THREE.BoxGeometry(6,0.15,2),
  new THREE.MeshStandardMaterial({color:"#818181"})
);
scene.add(ramp);

// Simple mannequin (procedural boxes)
function part(w,h,d,y){
  let m=new THREE.Mesh(new THREE.BoxGeometry(w,h,d),new THREE.MeshStandardMaterial({color:"#ffffff"}));
  m.position.y=y; return m;
}
let body = part(0.8,1.4,0.5,1.2);
let legL = part(0.3,1.4,0.3,0.3); legL.position.x=-0.3;
let legR = part(0.3,1.4,0.3,0.3); legR.position.x=0.3;
let armL = part(0.25,1.2,0.25,1.4); armL.position.x=-0.8;
let armR = part(0.25,1.2,0.25,1.4); armR.position.x=0.8;
let head = part(0.6,0.6,0.6,2.1);

let person = new THREE.Group();
person.add(body,legL,legR,armL,armR,head);
scene.add(person);
person.position.set(0,1.1,0);

// Animation
let step=0, direction=1, speed=1.2;
function animate(){
  requestAnimationFrame(animate);
  controls.update();
  step+=0.05*speed;

  legL.rotation.x = Math.sin(step)*0.7;
  legR.rotation.x = -Math.sin(step)*0.7;
  armL.rotation.x = -Math.sin(step)*0.5;
  armR.rotation.x = Math.sin(step)*0.5;

  person.position.z += direction * 0.015 * speed;
  if(person.position.z>0.9 || person.position.z<-0.9){
    direction*=-1;
    person.rotation.y += Math.PI;
  }

  renderer.render(scene,camera);
}
animate();

// UI bindings
document.getElementById("angle").oninput=e=>{
  ramp.rotation.z = -THREE.MathUtils.degToRad(e.target.value);
};
document.getElementById("speed").oninput=e=>{ speed=+e.target.value };
document.getElementById("personColor").oninput=e=>{
  person.traverse(o=>{ if(o.isMesh) o.material.color.set(e.target.value) });
};
document.getElementById("rampColor").oninput=e=>{
  ramp.material.color.set(e.target.value);
};

onresize=()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
};
</script>
</body>
</html>
